<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2018 by bmarmur (http://jsbin.com/hehosol/31/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
<meta name="description" content="MarmurFinalProjectv1">
 
<!--External Data-->	
<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/CC138D45-6C3B-474D-AE09-BA5EEBECB560/main.js" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/065BCEBEE5AB-90EA-D474-B3C6-54D831CC/abn/main.css"/><script src="https://indicator.extension.iastate.edu/z_cjs/teachingGIS/webGIS/studentFeaturesDB.php?userID=bmarmur&theFunction=responseVar"></script> 
  
 
		<script src="https://indicator.extension.iastate.edu/classes/leaflet-ajax-gh-pages/dist/leaflet.ajax.min.js"></script> 
  
  
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
  
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js">
  </script>
  
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
	
   <script
           src="https://bmarmur.github.io/LA558/data/treeData2.json"></script>
  
<style id="jsbin-css">
body {
 background-color: #1f487e;
}



#container {
 background: #E0e0e0;
 width: 1400px;
 height: 1050px;
 padding: 10px;
 margin-left: auto;
 margin-right: auto;
}

#header {
 background: #1f487e;
 color: #E0E0E0;
 width: 1340px;
 margin-left: auto;
 margin-right: auto;
 margin-top:20px;
 margin-bottom:20px ;
 text-align: center;
 padding: 5px;
}

#projectLink {
 background: #e0e0e0;
 color: #1f487e;
 width: 240px;
  border-style: solid;
    border-width: 5px;
   border-color: #607B7D;
 margin-left: auto;
 margin-right: auto;
 margin-top:20px;
 margin-bottom:20px ;
 text-align: center;
 padding: 0px;
}
#content {
 background: #AAAE8B;
 width: 1340px;
 height: 790px;
 margin-left:auto;
 margin-right:auto;
 
}

#mapBox {
  background: #607B7D;
  width: 700px;
 height: 535px;

 margin-left: 10px;
 margin-right: 5px;
 margin-top:10px;
 margin-bottom:10px ;
  float: left;
}

#speciesToggle {
 background-color:#1F487E;
  color: #E0E0E0;
 width: 650px;
 height: 75px;
 text-align: center;
 margin-left: auto;
 margin-right: auto;
 margin-top:10px;
 margin-bottom:10px;
 padding: 5px;
}

#map {
 width: 650px;
 height: 420px;
 background-color: thistle;
 margin-left: auto;
 margin-right: auto;
 margin-top:10px;
 margin-bottom:10px;
}

#infoBox {
 background: #607B7D;
 width: 610px;
 height: 535px;
 margin-left: 5px;
 margin-right: 10px;
 margin-top:10px;
 margin-bottom:10px ;
 float:right;
}

#infoToggle {
 background-color:#1F487E;
  color: #E0E0E0;
 width: 580px;
  height: 75px;
 margin-left: auto;
 margin-right: auto;
 margin-top:10px;
 margin-bottom:10px;
 text-align: center;
 padding: 5px;
 }

#treeText {
 background: #828E82;
 width: 580px;
 height: 410px;
 margin-left: auto;
 margin-right: auto;
 margin-top:10px;
 margin-bottom:10px;
 padding: 5px;
 text-align: center;
}

#treeImage {
 background: #828E82;
 height: 340px;
 margin-left: 0px:
 margin-right: 0px
 margin-top:0px;
 margin-bottom:10px;
 padding: 10px;
  text-align: center;
}

#addBox {
 background: #1f487e;
  color:#E0E0E0;
 width: 700px;
 height: 210px;
 margin-left:10px;
 margin-right: 0px;
 margin-top:0px;
 margin-bottom:10px;
 float: left
 }

#commentBox{
  background: #1f487e;
  color:#E0E0E0;
   width: 590px;
 height: 190px;
 margin-left:0px;
 margin-right: 10px;
 margin-top:0px;
 margin-bottom:10px;
  padding:10px;
 float: right
 }

#formBox {
  background: white;
  color: black;
  width: 250px;
  height: 65px;
  margin-left:auto;
 margin-right: auto;
 margin-top: 20px;
 margin-bottom:auto;
  padding: 20px;
}

.legend {
    line-height: 10px;
    color: #555;
}
.legend i {
    width: 18px;
    height: 20px;
    float: left;
    margin-right: 8px;
    opacity: 0.9;
}
.info {
    padding: 6px 8px;
    font: 10px/20px Arial, Helvetica, sans-serif;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}
.info h4 {
    margin: 0 0 5px;
    color: #777;
}


</style>
</head>
<body>
  <div id="container">
   
     <div id="header">
       <h1> Explore the Trees in a Des Moines Neighborhood! </h1>
       <h2>LA558 2018 Marmur Final Project</h2>
       <div id="projectLink">
       Check out my project presentation <a href="https://prezi.com/view/VeHTNzdXxGV9DuF8Hv6s/" syle="link:#E0E0E0">here!</a> Created in Prezi!
    </div>
     </div>
    
     <div id="content"> 
       
        <div id="mapBox">
           <div id="speciesToggle">

             Click to Show Tree Locations by Species
                <hr><input type="checkbox" id="hackberryCheck" value="hackberry"> Hackberry
          	    <input type="checkbox" id="sycamoreCheck" value="sycamore"> Sycamore
                <input type="checkbox" id="blackWalnutCheck" value="blackWalnut"> Black Walnut
                <input type="checkbox" id="treeOfHeavenCheck" value="treeOfHeaven"> Tree Of Heaven<br>
                <input type="checkbox" id="siberianElmCheck" value="siberianElm"> Siberian Elm
                <input type="checkbox" id="silverMapleCheck" value="silverMaple"> Silver Maple
                <input type="checkbox" id="mulberryCheck" value="mulberry"> Mulberry
                <input type="checkbox" id="allCheck" value="all"> All Trees<br>
            
            </div>
                <div id='map'></div>
        </div>
       
        <div id="infoBox">
          <div id="infoToggle">
             Click to Show An Image of the Tree Species
                <hr>
                <input type="radio" name="trees" id="hackberryImage" value="0"> Hackberry
          	    <input type="radio" name="trees" id="sycamoreImage" value="1"> Sycamore
                <input type="radio" name="trees" id="blackWalnutImage" value="2"> Black Walnut
                <input type="radio" name="trees" id="treeOfHeavenImage" value="3"> Tree Of Heaven<br>
                <input type="radio" name="trees" id="siberianElmImage" value="4"> Siberian Elm
                <input type="radio" name="trees" id="silverMapleImage" value="5"> Silver Maple
                <input type="radio" name="trees" id="mulberryImage" value="6"> Mulberry
                         </div>
          <div id="treeText">
                  <div id="treeImage">
                 <img id="tree0" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/hackberry.jpg" alt="Hackberry" style="width:339px;height:330px;">
                 <img id="tree1" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/sycamore.jpg" alt="Sycamore" style="width:270px;height:330px;">
                     <img id="tree2" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/blackWalnut.jpg" alt="Black Walnut" style="width:222px;height:330px;">
                 <img id="tree3" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/treeOfHeaven.jpg" alt="Tree of Heaven" style="width:400px;height:330px;">
                     <img id="tree4" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/siberianElm.jpg" alt="Siberian Elm" style="width:248px;height:330px;">
                 <img id="tree5" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/silverMaple.jpg" alt="Silver Maple" style="width:248px;height:330px;">
                     <img id="tree6" src="https://bmarmur.github.io/LA558/FinalProject/treePictures/mulberry.jpg" alt="Mulberry" style="width:450px;height:330px;">
                       </div>
            Images from The North American Insects and Spiders Tree Encyclopeida (cirrusimage.com/wp/trees/)
          </div>
        </div>
 
        <div id="addBox">
         <br> <h3 style="text-align:center;"> Know of a new tree in the neighborhood? <br>Enter the species and click the map to add the tree!</h3>
	<p style="text-align:center;"> Tree Speices: <input id = 'field1'> <br>
		Ready to add marker on map? Check here <input type="checkbox" id="addMarkReady" value="X"> then click map<br>(Be sure to unclick when you're done!)</p>
        </div>
       
        <div id="commentBox">
          <h3 style="text-align:center;">Have a comment about one of the trees in the neighborhood? <br>Please let us know below!</h3>
          <div id="formBox">
       <form action="https://bmarmur.github.io/LA558/FinalProject/welcome.php">
          
Tree ID: <input type="text" name="treeID"><br>
Comment: <input type="text" name="comment"><br>
<input type="submit">
          </form>
    </div>
          </div>
        </div>
     </div>
  
<script id="jsbin-javascript">
var userID = 'bmarmur';


var responseURL = "https://indicator.extension.iastate.edu/z_cjs/teachingGIS/webGIS/studentFeaturesDB.php?userID=" + userID + "&theFunction=response";


//Creating base layers
var OpenStreetMap_Mapnik = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});


var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});

var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'
});

//*************************************************

//set color by species
function getColor(d){
  return d == 'Sycamore' ? '#e41a1c':
  d == 'Black Walnut' ? '#377eb8':
  d == 'Hackberry' ? '#4daf4a':
  
  d == 'Siberian Elm' ? '#984ea3':
  d == 'Silver Maple' ? '#ff7f00':
  d == 'Tree of Heaven' ? '#ffff33':
  d == 'Mulberry spp' ? '#a65628':
  "#000000";
}

var map = L.map('map',{
    center:[41.5937, -93.5891],
      zoom: 17,
   layers: [OpenStreetMap_Mapnik]
});


function addPopups(feature, layer) {
  layer.bindPopup( 'Tree ID: ' + feature.properties.ID + "<br> Tree Species: " + feature.properties.Species + "<br> Tree Height: " + feature.properties.Ht_CanTop + " ft" + "<br> Canopy Diameter: " +feature.properties.CanAvDim + " ft");
 layer.bindTooltip("Tree ID: " + JSON.stringify(feature.properties.ID));

}


var geojsonMarkerOptions = {
  radius: 8,
  fillColor: "black", //overridden by category
  color: "#000",
  weight: 1,
  opacity: 1,
  fillOpacity: 0.8
};


//load filtered geojson into variable
var hackberryMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Hackberry') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});


var sycamoreMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Sycamore') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});

var treeOfHeavenMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Tree of Heaven') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});

var blackWalnutMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Black Walnut') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});

var siberianElmMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Siberian Elm') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});

var silverMapleMarkers = L.geoJson(treeData, {
  onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Silver Maple') {
      return true;
    }
  },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
  },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
});

var mulberryMarkers = L.geoJson(treeData, {
 onEachFeature: addPopups,
  filter: function(feature, layer) {
    if (feature.properties.Species == 'Mulberry spp') {
      return true;
          }
        },
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, geojsonMarkerOptions);
      },
  style: function(feature) {
    return {
      fillColor: getColor(feature.properties.Species),
    };
  }
 
}); 

var allTrees = L.layerGroup([hackberryMarkers, sycamoreMarkers, treeOfHeavenMarkers, blackWalnutMarkers, siberianElmMarkers, silverMapleMarkers, mulberryMarkers]);


//Listen for check box change
$("#hackberryCheck").change(function() {
  if ($(this).is(":checked")) {
    hackberryMarkers.addTo(map);
  } else {
    hackberryMarkers.remove(map);
  }
});


$("#sycamoreCheck").change(function() {
  if ($(this).is(":checked")) {
    sycamoreMarkers.addTo(map);
  } else {
    sycamoreMarkers.remove(map);
  }
});

$("#treeOfHeavenCheck").change(function() {
  if ($(this).is(":checked")) {
    treeOfHeavenMarkers.addTo(map);
  } else {
    treeOfHeavenMarkers.remove(map);
  }
});

$("#blackWalnutCheck").change(function() {
  if ($(this).is(":checked")) {
    blackWalnutMarkers.addTo(map);
  } else {
    blackWalnutMarkers.remove(map);
  }
});

$("#siberianElmCheck").change(function() {
  if ($(this).is(":checked")) {
    siberianElmMarkers.addTo(map);
  } else {
    siberianElmMarkers.remove(map);
  }
});

$("#silverMapleCheck").change(function() {
  if ($(this).is(":checked")) {
    silverMapleMarkers.addTo(map);
  } else {
    silverMapleMarkers.remove(map);
  }
});

$("#mulberryCheck").change(function() {
  if ($(this).is(":checked")) {
   mulberryMarkers.addTo(map);
  } else {
   mulberryMarkers.remove(map);
  }
});

$("#allCheck").change(function() {
  if ($(this).is(":checked")) {
    allTrees.addTo(map);  
    //$("#sycamoreCheck, #treeOfHeavenCheck, #blackWalnutCheck, #siberianElmCheck, #silverMapleCheck, #mulberryCheck, #hackberryCheck").checked();
  } else {
  allTrees.remove(map);
  }
});
//****************************************************

$(function() {

  var totalMaps = 8; //enter this manually

  //initially hide all maps
  for (i = 0; i < totalMaps; i++) {
    $("#tree" + i).hide();
  }

  //toggle basemap layers
  $('input:radio[name=trees]').click(function() {
    base = $('input:radio[name=trees]:checked').val();
    $("#tree0, #tree1, #tree2, #tree3, #tree4, #tree5, #tree6").hide(); //combined selectors in one line
    $("#tree" + base).show();
  });
});

//*********************************************
/*User added Markers
function onMapClick(e) {
  var newMarker = L.marker(e.latlng, {
  draggable: true,
  title: "New Tree",
  alt: "A new tree location",
  riseOnHover: true
    }).addTo(map)
  .bindPopup(e.latlng.toString()).openPopup(); 

newMarker.on("dragend", function(ev) {
  
  var chagedPos = ev.target.getLatLng();
this.bindPopup(chagedPos.toString()).openPopup();
});
}
map.on('click',onMapClick);
//***************************************************
*/

//User Add Marker for new trees
//Add the marker to the map and DB
function addMarker(e) {

  if ($("#addMarkReady").is(':checked')) {

    field1 = $("#field1").val();
    
    // Add marker to map at click location; add popup window
    var newMarker = new L.marker(e.latlng)
      .bindPopup("<strong>" + field1 + "</strong>")
      .bindTooltip(field1)
      .addTo(map);

    latitude = e.latlng.lat;
    longitude = e.latlng.lng;

    var myData = "field1=" + field1 + "&latitude=" + latitude + "&longitude=" + longitude;

    jQuery.ajax({
      type: "POST", // HTTP method POST or GET
      url: "https://indicator.extension.iastate.edu/z_cjs/teachingGIS/webGIS/studentFeaturesDB.php?userID=" + userID + "&theFunction=insert", //Where to make Ajax calls
      dataType: "text", // Data type, HTML, json etc.
      data: myData, //Form variables
      success: function(response) {
        //console.log(response);

      },
      error: function(xhr, ajaxOptions, thrownError) {
        console.log(thrownError);
      }

    }); //end ajax post
  }
}


//Load existing points as circles from var locations. This is initially loaded in a <head><script>
var geojsonLayer1 = L.geoJSON(locations, {
  pointToLayer: function(feature, latlng) {
    return L.circleMarker(latlng, {
      radius: 5,
      fillColor: "yellow",
      color: "#000",
      weight: 1,
      opacity: 1,
      fillOpacity: 0.8
    }).bindPopup(feature.properties.field1).openPopup();
  }
}).addTo(map);

//********************************************
//********************************************

//legend
var legend =L.control({position: 'bottomright'});

legend.onAdd=function(map) {
    var div = L.DomUtil.create('div', 'info legend'),
     TreeSpecies = ["Sycamore", "Black Walnut", "Hackberry", "Siberian Elm", "Silver Maple", "Tree of Heaven", "Mulberry spp", '' ],
     labels = ["Sycamore", "Black Walnut", "Hackberry", "Siberian Elm", "Silver Maple", "Tree of Heaven", "Mulberry", "Other"];
  
  //not sure what line 63 does? 
  	div.innerHTML += "<b>TreeSpecies</b><br>";
  // loop through items and generate a label with a colored square for each
  for (var i = 0; i < TreeSpecies.length; i++) {
    div.innerHTML +=
      '<i style="background:' + 
      getColor(TreeSpecies[i]) + ' "></i> ' +
      labels[i] + (TreeSpecies ? ' '+'<br>' :'');
                     } 
                     return div;
                     };legend.addTo(map);


//Layer Control
var baseMaps = {
  "Open Street Map": OpenStreetMap_Mapnik,
  "Imagery": Esri_WorldImagery,
  "Topo": Esri_WorldTopoMap
};


L.control.layers(baseMaps).addTo(map);


</script>
</body>
</html>